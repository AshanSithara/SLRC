<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: headerFragment}">
    <meta charset="UTF-8">
    <title> Page Home </title>
</head>
<body >

<main>
    <!-- left side menu -->
    <div th:replace="~{fragments/side_panel :: side_panel_fragment}"></div>

    <!-- rite side content wrapping area -->
    <div class="content_wrapper">

        <div class="content_section">
            <div class="container">
                <div class="theme-bg-transparent p-5 border-rounded-4">

                    <h1 class="mb-3">
                        <i class="fa fa-th-large"></i> Quick Access
                    </h1>

                    <hr>

                    <div class="row">
                        <div class="col-md-3">
                            <div class="card bg-success text-white">
                                <div class="card-body">

                                    <h3>
                                        <i class="fa fa-calendar"></i> Studio Calendar
                                    </h3>

                                    <p>Reserve Studio Here</p>

                                    <a class="text-decoration-none text-white" href="calendar-view">
                                        Goto <i class="fa fa-arrow-right"></i>
                                    </a>

                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-info text-white">
                                <div class="card-body">

                                    <h3>
                                        <i class="fa fa-calendar"></i> PPU Calendar
                                    </h3>

                                    <p>Reserve PPU here..</p>

                                    <a class="text-decoration-none text-white" href="ppu-calendar-view" >
                                        Goto <i class="fa fa-arrow-right"></i>
                                    </a>

                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-warning text-white">
                                <div class="card-body">

                                    <h3>
                                        <i class="fa fa-user-plus"></i> User
                                    </h3>

                                    <p>Team Details..</p>

                                    <a class="text-decoration-none text-white" href="team">
                                        Goto <i class="fa fa-arrow-right"></i>
                                    </a>


                                </div>
                            </div>
                        </div>
                    <!--    <div class="col-md-3">
                            <div class="card bg-primary text-white">
                                <div class="card-body" style="margin-bottom: 44.6px;">

                                    <h3>
                                        <i class="fa fa-user"></i>Profile
                                        <p display="inline" style="    text-align: center;" th:text="${username}"></p>
                                    </h3>


                                </div>
                            </div>
                        </div>-->
                        <div class="col-md-3">
                            <div class="card bg-primary text-white">
                                <div class="card-body">

                                    <h3>
                                        <i class="fa fa-user"></i> Profile
                                    </h3>

                                    <p display="inline" style="    text-align: center;" th:text="${user}"></p>
                                    <a class="text-decoration-none text-white" href="user-profile">
                                        View Profile <i class="fa fa-arrow-right"></i>
                                    </a>


                                </div>
                            </div>
                        </div>

                    </div>

                    <h1 class="mb-3 mt-5">
                        <i class="fa fa-chart-bar"></i> Report and Analytics
                    </h1>

                    <hr>

                    <div class="row mt-5">
                        <div class="col-md-6">
                            <div class="form-row">
                                <div class="col-md-3 mb-3">
                                    <input class="form-control" id="searchdate" name="searchdate"
                                           placeholder="Please Select Month"
                                           type="month">
                                    <div class="d-none" id="searchdateerror" style="color:red;">
                                        Please Select Date
                                    </div>
                                </div><!-- form-group -->
                                <button class="btn btn-primary mb-2 " id="search_button"
                                        onclick="searchdatanew()"
                                        type="button"><i
                                        class="fa fa-search "></i> Search
                                </button>
                            </div>
                            <canvas id="chartBar1"></canvas>
                        </div>
                        <div class="col-md-6">
                            <div class="form-row">
                                <div class="col-md-3 mb-3">
                                    <input class="form-control" id="searchdate2" name="searchdate2"
                                           placeholder="Please Select Month"
                                           type="month">
                                    <div class="d-none" id="searchdateerror2" style="color:red;">
                                        Please Select Date
                                    </div>
                                </div><!-- form-group -->
                                <button class="btn btn-primary mb-2 " id="search_button2"
                                        onclick="searchdatanew2()"
                                        type="button"><i
                                        class="fa fa-search "></i> Search
                                </button>
                            </div>


                            <canvas id="chartBar2"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- footer section -->
        <footer th:replace="~{fragments/footer :: footerFragment}"></footer>
    </div>
    <!-- rite side content wrapping area -->
</main>

<!--script include-->
<script th:replace="~{fragments/script :: scriptFragment}"></script>
<script th:replace="~{fragments/script :: scriptFragment}"></script>


<script src="http://cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment.min.js"
        th:src="@{/webjars/momentjs/2.9.0/min/moment.min.js}" type="text/javascript"></script>
<script src="http://cdn.jsdelivr.net/webjars/jquery/2.1.3/jquery.min.js"
        th:src="@{/webjars/jquery/2.1.3/jquery.min.js}" type="text/javascript"></script>
<script src="http://fullcalendar.io/js/fullcalendar-2.2.5/fullcalendar.min.js"
        th:src="@{/webjars/fullcalendar/2.2.5/fullcalendar.min.js}" type="text/javascript"></script>
<script crossorigin="anonymous"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script crossorigin="anonymous"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

<!--base Component -->
<script th:src="@{/dist/assets/base/baseComponet.js}" type="text/javascript"></script>

<!-- Toastr Js -->
<script th:src="@{/dist/assets/vendors/toastr/js/toastr.min.js}" type="text/javascript"></script>
<!-- Toastr Init -->
<script th:src="@{/dist/assets/js/init/toastr.js}" type="text/javascript"></script>


<!-- Data Table js -->
<script th:src="@{/dist/assets/vendors/jquery.steps/js/jquery.steps.js}"></script>
<script th:src="@{/dist/assets/vendors/data-table/js/jquery.dataTables.js}"></script>
<script th:src="@{/dist/assets/vendors/data-table/js/jquery.dataTables.min.js}"></script>
<script th:src="@{/dist/assets/vendors/data-table/js/dataTables.bootstrap4.min.js}"></script>
<script th:src="@{/dist/assets/vendors/data-table/js/dataTables.responsive.min.js}"></script>
<script th:src="@{/dist/assets/vendors/data-table/js/responsive.bootstrap.min.js}"></script>

<!-- Data table Init -->
<script th:src="@{/dist/assets/js/data-table.js}"></script>

<!--=========================*
           This Page Scripts
   *===========================-->


<!--Chart Js-->
<script th:src="@{/dist/assets/vendors/charts/charts-bundle/Chart.bundle.js}"></script>

<!--Float Js-->
<script th:src="@{/dist/assets/vendors/charts/float-bundle/jquery.flot.js}"></script>
<script th:src="@{/dist/assets/vendors/charts/float-bundle/jquery.flot.pie.js}"></script>
<script th:src="@{/dist/assets/vendors/charts/float-bundle/jquery.flot.resize.js}"></script>

<!--Easy pie chart Js-->
<script th:src="@{/dist/assets/vendors/charts/sparkline/easy-pie-chart.js}"></script>


<!--Home Script-->
<script th:src="@{/dist/assets/js/home.js}"></script>

<!--Chart Js-->
<script th:src="@{/dist/assets/vendors/charts/charts-bundle/Chart.bundle.js}"></script>
<script th:src="@{/dist/assets/js/init/chart-js.js}"></script>

<script>

    let ctx1 = document.getElementById('chartBar1').getContext('2d');

    myChart = new Chart(ctx1, {
        type: 'bar',
        data: {
            labels: [],
            datasets: [{
                label: 'Studio Reservation',
                data: [],
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(255, 159, 64, 0.2)'
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            }
        }
    });


    function updateChart(chart, data) {
        chart.data.labels = data.label;
        chart.data.datasets = [{
            label: 'Hours',
            labels: data.label,
            data: data.data,
            backgroundColor: '#276aff'
        }];
        chart.update();
    }

    function searchdatanew() {
        let date = $('#searchdate').val();
        eventbyhours(date);
    }

    function eventbyhours(date) {
        $.ajax({
            url: baseURL + 'report/daybyhour-report/' + date,
            method: "GET",
            headers: {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            },
            async: true,
            dataType: "json"
        }).done(function (resp) {
            let chartLabel = [];
            let chartData = [];
            let commondata = [];
            let array2 = [];
            for (let data of resp) {
                let title = data['month_date'];
                chartLabel.push(title);

                let datum = data['monthhourcount'];
                chartData.push(parseInt(datum));

                commondata = {x: title, y: datum};
                array2.push(commondata);


            }

            console.log(commondata);
            updateChart(myChart, {
                label: chartLabel,
                data: array2
            })
        });
    };



    //PPU Section
    let ctx2= document.getElementById('chartBar2').getContext('2d');

    myChart2 = new Chart(ctx2, {
        type: 'bar',
        data: {
            labels: [],
            datasets: [{
                label: 'PPU Reservation',
                data: [],
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(255, 159, 64, 0.2)'
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            }
        }
    });


    function updateChart(chart, data) {
        chart.data.labels = data.label;
        chart.data.datasets = [{
            label: 'Hours',
            labels: data.label,
            data: data.data,
            backgroundColor: '#276aff'
        }];
        chart.update();
    }

    function searchdatanew2() {
        let date = $('#searchdate2').val();
        eventbyhours2(date);
    }

    function eventbyhours2(date) {
        $.ajax({
            url: baseURL + 'report/ppu-day-report/' + date,
            method: "GET",
            headers: {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            },
            async: true,
            dataType: "json"
        }).done(function (resp) {
            let chartLabel = [];
            let chartData = [];
            let commondata = [];
            let array3 = [];
            for (let data of resp) {
                let title = data['month_date'];
                chartLabel.push(title);

                let datum = data['monthhourcount'];
                chartData.push(parseInt(datum));

                commondata = {x: title, y: datum};
                array3.push(commondata);


            }

            console.log(commondata);
            updateChart(myChart2, {
                label: chartLabel,
                data: array3
            })
        });
    };


</script>

</body>
</html>
